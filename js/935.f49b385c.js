"use strict";(self["webpackChunkvue_week6"]=self["webpackChunkvue_week6"]||[]).push([[935],{1417:function(t,i,e){e.d(i,{Z:function(){return k}});var a=e(3396),o=e(7139),s=e(9242);const r={class:"card-title bg-primary"},n={class:"text-medium text-c-white"},c=["disabled"],d={key:0},l=(0,a._)("i",{class:"fas fa-pulse fa-spinner"},null,-1),u=[l],p={key:1},g={class:"card-footer"},h={class:"text-c-primary text-left mb-2"},v={class:"user-price d-flex align-items-center jy-content-between"},f={class:"user-price-discount"};function y(t,i,e,l,y,m){return(0,a.wg)(),(0,a.iD)("div",{class:"card",onClick:i[3]||(i[3]=t=>m.routerTo(e.product.id))},[(0,a._)("div",{class:(0,o.C_)(["favor",{hide:y.isFavorHide}])},[y.isFavor.includes(e.product.id)?((0,a.wg)(),(0,a.iD)("span",{key:0,onClick:i[0]||(i[0]=(0,s.iM)((i=>t.$emit("favorHandler","remove",e.product.id)),["stop"]))},"🧡")):((0,a.wg)(),(0,a.iD)("span",{key:1,onClick:i[1]||(i[1]=(0,s.iM)((i=>t.$emit("favorHandler","add",e.product.id)),["stop"]))},"🤍"))],2),(0,a._)("div",r,[(0,a._)("h3",n,(0,o.zw)(y.title),1)]),(0,a._)("div",{class:"card-body",style:(0,o.j5)({backgroundImage:`url(${e.product.imageUrl})`})},[(0,a._)("div",{class:(0,o.C_)(["addToCart d-none d-sm-block",{"z-index-bottom":"white"===e.originColor}])},[(0,a._)("button",{onClick:i[2]||(i[2]=(0,s.iM)((i=>t.$emit("addCart",1,e.product.id)),["stop"])),type:"button",class:"user-btn user-btn-thirdary py-3",disabled:y.isBtnLoading===e.product.id},[y.isBtnLoading===e.product.id?((0,a.wg)(),(0,a.iD)("span",d,u)):((0,a.wg)(),(0,a.iD)("span",p,"加入購物車"))],8,c)],2)],4),(0,a._)("div",g,[(0,a._)("h4",{class:"text-medium text-left",style:(0,o.j5)({color:e.originColor})},(0,o.zw)(e.product.title),5),(0,a._)("p",h,(0,o.zw)(e.product.unit)+" / "+(0,o.zw)(e.product.content),1),(0,a._)("div",v,[(0,a._)("p",{class:"user-price-origin",style:(0,o.j5)({color:e.originColor})},"$"+(0,o.zw)(e.product.origin_price),5),(0,a._)("p",f,"$"+(0,o.zw)(e.product.price),1)])])])}var m={props:["titleColor","originColor","product","isLoading","favor"],emits:["addCart","favorHandler"],data(){return{title:"雙北隔日配",content:"這是內容",footer:"這是結尾",isBtnLoading:"",isFavor:[],isFavorHide:!0}},methods:{routerTo(t){this.$router.push(`/product/${t}`)}},watch:{isLoading(){this.isBtnLoading=this.isLoading},favor(){this.isFavor=this.favor}},mounted(){this.isFavor=this.favor||[],-1!==this.$route.fullPath.indexOf("/product")&&-1===this.$route.fullPath.indexOf("/product/")?this.isFavorHide=!1:this.isFavorHide=!0}},_=e(89);const w=(0,_.Z)(m,[["render",y]]);var k=w},1894:function(t,i,e){e.d(i,{Z:function(){return f}});var a=e(3396),o=e(7139),s=e(9242);const r=t=>((0,a.dD)("data-v-1b51ac8a"),t=t(),(0,a.Cn)(),t),n=r((()=>(0,a._)("span",null,[(0,a._)("i",{class:"fas fa-chevron-left"}),(0,a.Uk)("Prev")],-1))),c=[n],d=["onClick"],l=r((()=>(0,a._)("span",null,[(0,a.Uk)("Next"),(0,a._)("i",{class:"fas fa-chevron-right"})],-1))),u=[l];function p(t,i,e,r,n,l){return e.pagination.total_pages>1&&void 0!==e.pagination.total_pages?((0,a.wg)(),(0,a.iD)("ul",{key:0,class:"pagination d-flex align-items-center jy-content-center",style:(0,o.j5)({backgroundColor:e.style.bg})},[(0,a.wy)((0,a._)("li",{style:(0,o.j5)(l.styleObject),class:"pagination__prev",onClick:i[0]||(i[0]=i=>t.$emit("getProduct",e.pagination.current_page-1))},c,4),[[s.F8,e.pagination.has_pre]]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.pagination.total_pages,(i=>((0,a.wg)(),(0,a.iD)("li",{class:(0,o.C_)(["pagination__item",{active:i===e.pagination.current_page}]),key:i,style:(0,o.j5)(l.styleObject),onClick:e=>t.$emit("getProduct",i)},[(0,a._)("span",null,(0,o.zw)(i),1)],14,d)))),128)),(0,a.wy)((0,a._)("li",{style:(0,o.j5)(l.styleObject),class:"pagination__next",onClick:i[1]||(i[1]=i=>t.$emit("getProduct",e.pagination.current_page+1))},u,4),[[s.F8,e.pagination.has_next]])],4)):(0,a.kq)("",!0)}var g={props:["pagination","style"],emits:["getProduct"],computed:{styleObject(){return{"--background":this.style.bg,"--background-hover":this.style.hoverBg}}}},h=e(89);const v=(0,h.Z)(g,[["render",p],["__scopeId","data-v-1b51ac8a"]]);var f=v},6935:function(t,i,e){e.r(i),e.d(i,{default:function(){return k}});var a=e(3396),o=e(7139);const s=t=>((0,a.dD)("data-v-e8de6eae"),t=t(),(0,a.Cn)(),t),r={key:0,class:"text-title text-center mb-10"},n={key:1,class:"text-title text-center mb-10"},c={class:"row product-content"},d={class:"addToCart d-sm-none"},l=["onClick","disabled"],u={key:0},p=s((()=>(0,a._)("i",{class:"fas fa-pulse fa-spinner"},null,-1))),g=[p],h={key:1};function v(t,i,e,s,p,v){const f=(0,a.up)("CardView"),y=(0,a.up)("PageView");return(0,a.wg)(),(0,a.iD)(a.HY,null,["全部商品"!==p.category&&"我的最愛"!==p.category&&void 0!==p.category?((0,a.wg)(),(0,a.iD)("h2",r,"放心初-精選"+(0,o.zw)(p.category),1)):((0,a.wg)(),(0,a.iD)("h2",n,(0,o.zw)(p.category||"全部商品"),1)),(0,a._)("div",c,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(p.products,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"col-xs-6 col-sm-4 col-md-3 mb-4 p-relative hover-big",key:t.id},[(0,a._)("div",d,[(0,a._)("button",{onClick:i=>v.addCart(1,t.id),type:"button",class:"user-btn user-btn-thirdary py-3",disabled:p.isBtnLoading===t.id},[p.isBtnLoading===t.id?((0,a.wg)(),(0,a.iD)("span",u,g)):((0,a.wg)(),(0,a.iD)("span",h,"加入購物車"))],8,l)]),(0,a.Wm)(f,{onAddCart:v.addCart,onFavorHandler:v.favorHandler,favor:p.favor,"title-color":"white",product:t,"is-loading":p.isBtnLoading},null,8,["onAddCart","onFavorHandler","favor","product","is-loading"])])))),128))]),(0,a.Wm)(y,{pagination:p.pagination,style:(0,o.j5)(p.style),onGetProduct:v.getProducts},null,8,["pagination","style","onGetProduct"])],64)}var f=e(1417),y=e(1894),m={data(){return{products:[],cart:[],tempCartProduct:{},pagination:{},style:{bg:"#C59854",hoverBg:"#A01800"},isBtnLoading:"",category:"",favor:[],favorProduct:[]}},components:{CardView:f.Z,PageView:y.Z},methods:{getProducts(t=1){if(this.category=this.$route.query.category,void 0!==this.$route.params.products)return this.products=[...JSON.parse(this.$route.params.products)],void(this.pagination={});this.$emitter.emit("isLoading",!0);let i=`https://vue3-course-api.hexschool.io/v2/api/ginjack/products?page=${t}`;if(""===this.category||"全部商品"===this.category||void 0===this.category)i=`https://vue3-course-api.hexschool.io/v2/api/ginjack/products?page=${t}`;else{if("我的最愛"===this.category)return this.getFavorProduct(),void(this.pagination={});i=`https://vue3-course-api.hexschool.io/v2/api/ginjack/products?category=${this.category}&&page=${t}`}this.$http.get(i).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination,this.$emitter.emit("isLoading",!1)})).catch((t=>{console.dir(t),this.$emitter.emit("isLoading",!1)}))},getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ginjack/cart").then((t=>{this.$emitter.emit("updateCart",t.data.data)})).catch((t=>{console.dir(t)}))},addCart(t,i){const e={data:{product_id:i,qty:t}};this.isBtnLoading=i,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ginjack/cart",e).then((t=>{this.getCart(),this.$swal("成功!",`${t.data.data.product.title}-加入購物車`,"success"),this.isBtnLoading=""})).catch((t=>{console.dir(t)}))},favorHandler(t,i){if("add"===t)this.favor.push(i),localStorage.setItem("favor",JSON.stringify(this.favor)),this.$swal("成功!","加入最愛","success");else{if(this.favor.splice(this.favor.indexOf(i),1),localStorage.setItem("favor",JSON.stringify(this.favor)),"我的最愛"===this.$route.query.category)return void this.getProducts();this.$swal("成功!","移除最愛","success")}},getFavorProduct(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ginjack/products/all").then((t=>{this.$emitter.emit("isLoading",!1);const i=t.data.products;this.products=i.filter((t=>-1!==this.favor.indexOf(t.id)))})).catch((t=>{console.dir(t)}))}},watch:{$route(t){this.category=t.query.category,void 0!==t.params.products&&(this.products=[...JSON.parse(t.params.products)],this.pagination={})},category(){this.getProducts()}},mounted(){this.getProducts(),this.favor=JSON.parse(localStorage.getItem("favor"))||[]}},_=e(89);const w=(0,_.Z)(m,[["render",v],["__scopeId","data-v-e8de6eae"]]);var k=w}}]);
//# sourceMappingURL=935.f49b385c.js.map