"use strict";(self["webpackChunkvue_week6"]=self["webpackChunkvue_week6"]||[]).push([[599],{599:function(t,e,s){s.r(e),s.d(e,{default:function(){return tt}});var a=s(3396),c=s(7139),i=s(9242);const o=t=>((0,a.dD)("data-v-139e9a8c"),t=t(),(0,a.Cn)(),t),n={key:0,class:"mb-10"},l=(0,a.uE)('<li class="row py-4 bg-secondary d-sm-none" data-v-139e9a8c><div class="col-sm-4" data-v-139e9a8c><p class="text-center text-c-white" data-v-139e9a8c>商品</p></div><div class="col-sm-2" data-v-139e9a8c><p class="text-center text-c-white" data-v-139e9a8c>數量</p></div><div class="col-sm-2" data-v-139e9a8c><p class="text-center text-c-white" data-v-139e9a8c>售價</p></div><div class="col-sm-2" data-v-139e9a8c><p class="text-center text-c-white" data-v-139e9a8c>小計</p></div><div class="col-sm-2" data-v-139e9a8c><p class="text-center text-c-white" data-v-139e9a8c>操作</p></div></li>',1),r={class:"col-sm-4 d-flex jy-content-center jy-content-sm-start mb-sm-2"},d={class:"content px-3"},u={class:"text-medium"},p=o((()=>(0,a._)("br",null,null,-1))),m={class:"d-md-none d-sm-block"},h={class:"col-xs-6 col-sm-2"},x=["onUpdate:modelValue","onChange"],y=["value"],g={class:"col-2 d-sm-none"},b={class:"text-medium text-center text-c-primary"},v={class:"col-xs-4 col-sm-2"},w={class:"text-medium text-center text-c-primary"},_={class:"col-2"},f=["onClick"],k=o((()=>(0,a._)("span",{class:"text-c-white"}," X ",-1))),$=[k],C={class:"row py-4 bg-white align-items-center border-b-1 jy-content-end"},z=o((()=>(0,a._)("div",{class:"col-xs-5 col-sm-2"},[(0,a._)("p",{class:"text-medium text-center text-c-primary text-sm-right"},"總計")],-1))),j={class:"col-xs-5 col-sm-2"},T={class:"text-medium text-center text-c-primary f-size-s text-sm-right"},L={class:"row py-6 bg-white jy-content-between"},D={class:"col-sm-6 col-md-4 d-flex flex-dir-col jy-content-between"},q={class:"coupon d-flex mb-sm-4"},N=["readonly"],U=["disabled"],H={key:0},I={key:1},M={class:"text-medium d-flex jy-content-between mb-sm-2"},V=o((()=>(0,a._)("span",null,"商品小計",-1))),Y={class:"text-c-primary f-w-bold"},B={class:"text-medium d-flex jy-content-between mb-sm-2"},K=o((()=>(0,a._)("span",null,"優惠折扣",-1))),E={class:"text-c-primary f-w-bold"},F={class:"col-sm-6 col-md-4"},S={class:"text-sm-right"},W=(0,a.Uk)(" 結帳金額"),X=o((()=>(0,a._)("br",null,null,-1))),Z={class:"text-c-primary f-size-s f-w-bold my-2 d-block"},A={class:"empty-cart mb-20 mt-sm-20"},G=o((()=>(0,a._)("h3",{class:"text-title text-c-forthary text-center mb-4"},"購物車是空的",-1))),J=o((()=>(0,a._)("button",{class:"user-btn user-btn-primary mx-auto py-4 px-10 f-size-s"},"前往選購商品",-1)));function O(t,e,s,o,k,O){const P=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[k.carts?.carts?.length?((0,a.wg)(),(0,a.iD)("ul",n,[l,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(k.carts.carts,(t=>((0,a.wg)(),(0,a.iD)("li",{class:"row py-4 bg-white align-items-center border-b-1",key:t.id},[(0,a._)("div",r,[(0,a._)("div",{class:"img-bg px-1",style:(0,c.j5)({backgroundImage:"url("+t.product.imageUrl+")"})},null,4),(0,a._)("div",d,[(0,a._)("h3",u,(0,c.zw)(t.product.title),1),(0,a._)("p",null,[(0,a.Uk)(" 規格："+(0,c.zw)(t.product.unit),1),p,(0,a._)("span",m,"重量："+(0,c.zw)(t.product.content),1)])])]),(0,a._)("div",h,[(0,a.wy)((0,a._)("select",{class:"py-2",name:"qty",id:"qty","onUpdate:modelValue":e=>t.qty=e,onChange:e=>O.updateCart(t,t.qty)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.qty+10,((t,e)=>((0,a.wg)(),(0,a.iD)("option",{key:t+e,value:t},(0,c.zw)(t),9,y)))),128))],40,x),[[i.bM,t.qty]])]),(0,a._)("div",g,[(0,a._)("p",b," NT $"+(0,c.zw)(t.product.price),1)]),(0,a._)("div",v,[(0,a._)("p",w," NT $"+(0,c.zw)(t.total),1)]),(0,a._)("div",_,[(0,a._)("button",{type:"button",class:"user-btn user-btn-primary m-auto py-1 px-2",onClick:e=>O.deleteCart(t.id)},$,8,f)])])))),128)),(0,a._)("li",C,[z,(0,a._)("div",j,[(0,a._)("p",T," NT $"+(0,c.zw)(k.carts.total),1)])]),(0,a._)("li",L,[(0,a._)("div",D,[(0,a._)("div",q,[(0,a.wy)((0,a._)("input",{class:"w-60 p-2 f-size-xs",type:"text",id:"coupon","onUpdate:modelValue":e[0]||(e[0]=t=>k.coupon=t),readonly:k.carts.total!==k.carts.final_total},null,8,N),[[i.nr,k.coupon]]),(0,a._)("button",{class:"user-btn user-btn-primary py-2 flex-auto",type:"button",onClick:e[1]||(e[1]=(...t)=>O.useCoupon&&O.useCoupon(...t)),disabled:k.carts.total!==k.carts.final_total},[k.carts.total==k.carts.final_total?((0,a.wg)(),(0,a.iD)("span",H,"使用優惠卷")):((0,a.wg)(),(0,a.iD)("span",I,"已使用過優惠卷"))],8,U)]),(0,a._)("p",M,[V,(0,a._)("span",Y,"NT$ "+(0,c.zw)(k.carts.total),1)]),(0,a._)("p",B,[K,(0,a._)("span",E," NT$ "+(0,c.zw)(Math.round(k.carts.total-k.carts.final_total)),1)])]),(0,a._)("div",F,[(0,a._)("p",S,[W,X,(0,a._)("span",Z," NT$ "+(0,c.zw)(Math.round(k.carts.final_total)),1)]),(0,a._)("button",{class:"user-btn user-btn-primary w-100 py-3 f-size-xs d-sm-none",type:"button",onClick:e[2]||(e[2]=(...t)=>O.routerTo&&O.routerTo(...t))},"下一步：填寫資料")])])])):(0,a.kq)("",!0),k.carts?.carts?.length?((0,a.wg)(),(0,a.iD)("button",{key:1,class:"cart-check-btn user-btn user-btn-primary w-100 py-3 f-size-xs",type:"button",onClick:e[3]||(e[3]=(...t)=>O.routerTo&&O.routerTo(...t))},"下一步：填寫資料")):(0,a.kq)("",!0),(0,a.wy)((0,a._)("div",A,[G,(0,a.Wm)(P,{to:"/product"},{default:(0,a.w5)((()=>[J])),_:1})],512),[[i.F8,0===k.carts?.carts?.length]])],64)}var P={data(){return{carts:[],coupon:""}},methods:{getCarts(){this.$emitter.emit("isLoading",!0),this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ginjack/cart").then((t=>{if(this.$emitter.emit("isLoading",!1),this.carts=t.data.data,0===this.carts.carts.length)return this.$emitter.emit("changeBar",0),this.$emitter.emit("updateCart",t.data.data),void this.$emitter.emit("isLoading",!1);this.$emitter.emit("changeBar",1),this.$emitter.emit("isLoading",!1)})).catch((t=>{console.log(t),this.$emitter.emit("isLoading",!1)}))},updateCart(t,e){this.$emitter.emit("isLoading",!0);const s={product_id:t.product_id,qty:e};this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/ginjack/cart/${t.id}`,{data:s}).then((()=>{this.getCarts()})).catch((t=>{this.$emitter.emit("isLoading",!1),console.dir(t)}))},deleteCart(t){this.$emitter.emit("isLoading",!0),this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ginjack/cart/${t}`).then((()=>{this.getCarts()})).catch((t=>{this.$emitter.emit("isLoading",!1),console.dir(t)}))},useCoupon(){if(""===this.coupon)return void alert("欄位不可為空");this.$emitter.emit("isLoading",!0);const t={code:this.coupon};this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ginjack/coupon",{data:t}).then((t=>{this.getCarts()})).catch((()=>{this.$emitter.emit("isLoading",!1),this.$swal({icon:"error",title:"失敗",text:"查無此優惠卷"})}))},routerTo(){this.$router.push({name:"資料輸入頁面",params:{show:!0}})}},mounted(){this.getCarts(),this.coupon=localStorage.getItem("couponText")}},Q=s(89);const R=(0,Q.Z)(P,[["render",O],["__scopeId","data-v-139e9a8c"]]);var tt=R}}]);
//# sourceMappingURL=599.deb3c7d5.js.map