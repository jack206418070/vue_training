"use strict";(self["webpackChunkvue_week6"]=self["webpackChunkvue_week6"]||[]).push([[68],{7453:function(e,t,o){o.d(t,{Z:function(){return g}});var a=o(3396),s=o(7139),n=o(9242);const i={key:0,class:"productModal"},l={class:"delete__content"},c={key:0},d={key:1},p={key:2},u={key:3},r={class:"d-flex jy-content-between bg--dark--secondary py-1"};function m(e,t,o,m,h,_){return h.isShow?((0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("h2",null,"刪除"+(0,s.zw)(h.type),1),(0,a._)("div",l,["訂單"===h.type?((0,a.wg)(),(0,a.iD)("p",c,"確定要刪除 "+(0,s.zw)(o.data.user.name)+" "+(0,s.zw)(o.data.create_at)+" 的訂單嗎？",1)):"優惠卷"===h.type?((0,a.wg)(),(0,a.iD)("p",d,"確定要刪除 "+(0,s.zw)(o.data.title)+" 這個優惠卷嗎？",1)):"商品"===h.type?((0,a.wg)(),(0,a.iD)("p",p,"確定要刪除 "+(0,s.zw)(o.data.title)+" 這個商品嗎？",1)):"文章"===h.type?((0,a.wg)(),(0,a.iD)("p",u,"確定要刪除 "+(0,s.zw)(o.data.title)+" 的文章嗎？",1)):(0,a.kq)("",!0)]),(0,a._)("div",r,[(0,a._)("a",{onClick:t[0]||(t[0]=(0,n.iM)((t=>e.$emit("closeBack")),["prevent"])),class:"btn btn--danger mx-3",href:"#"},"取消"),(0,a._)("a",{onClick:t[1]||(t[1]=(0,n.iM)((t=>e.$emit("delData",o.data.id)),["prevent"])),class:"btn btn--success mx-3",href:"#"}," 刪除"+(0,s.zw)(h.type),1)])])):(0,a.kq)("",!0)}var h={props:["data"],emits:["delData","closeBack"],data(){return{isShow:!1,type:""}},methods:{openModal(e){this.isShow=!0,this.type=e},closeModal(){this.isShow=!1,this.type=""}}},_=o(89);const w=(0,_.Z)(h,[["render",m],["__scopeId","data-v-f81bf152"]]);var g=w},1894:function(e,t,o){o.d(t,{Z:function(){return w}});var a=o(3396),s=o(7139),n=o(9242);const i=e=>((0,a.dD)("data-v-1b51ac8a"),e=e(),(0,a.Cn)(),e),l=i((()=>(0,a._)("span",null,[(0,a._)("i",{class:"fas fa-chevron-left"}),(0,a.Uk)("Prev")],-1))),c=[l],d=["onClick"],p=i((()=>(0,a._)("span",null,[(0,a.Uk)("Next"),(0,a._)("i",{class:"fas fa-chevron-right"})],-1))),u=[p];function r(e,t,o,i,l,p){return o.pagination.total_pages>1&&void 0!==o.pagination.total_pages?((0,a.wg)(),(0,a.iD)("ul",{key:0,class:"pagination d-flex align-items-center jy-content-center",style:(0,s.j5)({backgroundColor:o.style.bg})},[(0,a.wy)((0,a._)("li",{style:(0,s.j5)(p.styleObject),class:"pagination__prev",onClick:t[0]||(t[0]=t=>e.$emit("getProduct",o.pagination.current_page-1))},c,4),[[n.F8,o.pagination.has_pre]]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.pagination.total_pages,(t=>((0,a.wg)(),(0,a.iD)("li",{class:(0,s.C_)(["pagination__item",{active:t===o.pagination.current_page}]),key:t,style:(0,s.j5)(p.styleObject),onClick:o=>e.$emit("getProduct",t)},[(0,a._)("span",null,(0,s.zw)(t),1)],14,d)))),128)),(0,a.wy)((0,a._)("li",{style:(0,s.j5)(p.styleObject),class:"pagination__next",onClick:t[1]||(t[1]=t=>e.$emit("getProduct",o.pagination.current_page+1))},u,4),[[n.F8,o.pagination.has_next]])],4)):(0,a.kq)("",!0)}var m={props:["pagination","style"],emits:["getProduct"],computed:{styleObject(){return{"--background":this.style.bg,"--background-hover":this.style.hoverBg}}}},h=o(89);const _=(0,h.Z)(m,[["render",r],["__scopeId","data-v-1b51ac8a"]]);var w=_},7068:function(e,t,o){o.r(t),o.d(t,{default:function(){return Q}});var a=o(3396),s=o(7139),n=o(9242);const i={class:"content"},l={class:"admin-container d-flex jy-content-center"},c={class:"total__product w-100 d-flex align-items-center jy-content-between"},d={class:"product w-100 mb-3"},p=(0,a.uE)('<li class="product__title d-flex jy-content-between"><h3 class="text-c-white f-w-bold">到期日</h3><div class="info__group w-90"><ul class="d-flex fw-bold align-items-center"><li class="w-30 f-w-bold">優惠名稱</li><li class="w-30 f-w-bold">優惠內容</li><li class="w-15 f-w-bold">是否啟用</li><li class="w-25 f-w-bold">編輯</li></ul></div></li>',1),u={class:"info__group w-90"},r={class:"d-flex fw-bold align-items-center"},m={class:"w-30 f-w-bold"},h={class:"w-30 f-w-bold"},_={class:"w-15 f-w-bold d-flex jy-content-center px-4"},w=["onClick"],g={key:0,class:"active"},b={key:1,style:{color:"red"}},f={class:"w-25 f-w-bold d-flex jy-content-center flex-wrap"},C=["onClick"],k=(0,a._)("i",{class:"fas fa-edit"},null,-1),v=[k],y=["onClick"],M=(0,a._)("i",{class:"fas fa-trash-alt"},null,-1),x=[M];function D(e,t,o,k,M,D){const $=(0,a.up)("PageView"),j=(0,a.up)("ModalView"),V=(0,a.up)("DelModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[M.back_show?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"back-lock",onClick:t[0]||(t[0]=e=>D.closeAllModal())})):(0,a.kq)("",!0),(0,a._)("div",i,[(0,a._)("div",l,[(0,a._)("div",c,[(0,a._)("p",null,"目前有 "+(0,s.zw)(M.coupons.length)+" 個優惠卷",1),(0,a._)("a",{class:"btn btn--success w-10",href:"#",onClick:t[1]||(t[1]=(0,n.iM)((e=>D.openCouponModal(!0)),["prevent"]))},"建立優惠卷")]),(0,a._)("div",d,[(0,a._)("ul",null,[p,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(M.coupons,(t=>((0,a.wg)(),(0,a.iD)("li",{key:t.id,class:"product__item d-flex jy-content-between"},[(0,a._)("h3",null,(0,s.zw)(e.$filters.date(t.due_date)),1),(0,a._)("div",u,[(0,a._)("ul",r,[(0,a._)("li",m,(0,s.zw)(t.title),1),(0,a._)("li",h,(0,s.zw)(t.percent),1),(0,a._)("li",_,[(0,a._)("div",{class:(0,s.C_)(["toggle",{active:1===t.is_enabled}]),onClick:e=>{1===t.is_enabled?t.is_enabled=0:t.is_enabled=1,M.isNew=!1,D.updateCoupon(t)}},null,10,w),1===t.is_enabled?((0,a.wg)(),(0,a.iD)("p",g," 啟用 ")):((0,a.wg)(),(0,a.iD)("p",b,"未啟用"))]),(0,a._)("li",f,[(0,a._)("a",{class:"btn btn--success w-30 mx-2",href:"#",onClick:(0,n.iM)((e=>D.openCouponModal(!1,t)),["prevent"])},v,8,C),(0,a._)("a",{class:"btn btn--danger w-30 mx-2",href:"#",onClick:(0,n.iM)((e=>D.openDelModal("優惠卷",t)),["prevent"])},x,8,y)])])])])))),128))])])]),(0,a.Wm)($,{pagination:M.pagination,onGetProduct:D.getCoupon,style:{bg:"#1A535C",hoverBg:"#FF6B6B"}},null,8,["pagination","onGetProduct"]),(0,a.Wm)(j,{coupon:M.tempCoupon,"is-new":M.isNew,onUpdateCoupon:D.updateCoupon,ref:"couponModal",onCloseBack:D.closeAllModal},null,8,["coupon","is-new","onUpdateCoupon","onCloseBack"]),(0,a.Wm)(V,{data:M.tempCoupon,onDelData:D.delCoupon,ref:"delModal",onCloseBack:D.closeAllModal},null,8,["data","onDelData","onCloseBack"])])],64)}const $={key:0,class:"coupon-modal bg--white"},j={class:"bg--primary py-3 text-c-white f-w-bold f-size-s text-center"},V={key:0},z={key:1},A={class:"form-control mb-4"},B=(0,a._)("label",{class:"text-medium",for:"name"},"優惠卷名稱*",-1),W={class:"form-control mb-4"},S=(0,a._)("label",{class:"text-medium",for:"percent"},"優惠折數(%)*",-1),N={class:"form-control mb-4"},q=(0,a._)("label",{class:"text-medium",for:"due_date"},"優惠到期日*",-1),P={class:"form-control mb-4"},U=(0,a._)("label",{class:"text-medium mb-1",for:"percent"},"是否啟用",-1),Z={class:"form-control mb-4"},L=(0,a._)("label",{class:"text-medium",for:"code"},"優惠卷CODE*",-1),F={class:"btn-group bg--secondary jy-content-between"};function O(e,t,o,i,l,c){const d=(0,a.up)("FieldView"),p=(0,a.up)("ErrorMessage"),u=(0,a.up)("FormView");return l.is_show?((0,a.wg)(),(0,a.iD)("div",$,[(0,a._)("h3",j,[o.isNew?((0,a.wg)(),(0,a.iD)("span",V,"新增優惠卷")):((0,a.wg)(),(0,a.iD)("span",z,"修改優惠卷"))]),(0,a.Wm)(u,{class:"form-block"},{default:(0,a.w5)((({errors:e})=>[(0,a._)("div",A,[B,(0,a.Wm)(d,{class:(0,s.C_)(["my-2 p-2",{is_invalid:e["name"]}]),id:"name",name:"name",type:"text",placeholder:"輸入優惠卷名稱",rules:"required",modelValue:l.tempCoupon.title,"onUpdate:modelValue":t[0]||(t[0]=e=>l.tempCoupon.title=e)},null,8,["class","modelValue"]),(0,a.Wm)(p,{style:{color:"red"},name:"name",class:"invalid-feeback"})]),(0,a._)("div",W,[S,(0,a.Wm)(d,{class:(0,s.C_)(["my-2 p-2",{is_invalid:e["percent"]}]),id:"percent",name:"percent",type:"number",min:"1",placeholder:"輸入打折數(%)",rules:"required",modelValue:l.tempCoupon.percent,"onUpdate:modelValue":t[1]||(t[1]=e=>l.tempCoupon.percent=e),modelModifiers:{number:!0}},null,8,["class","modelValue"]),(0,a.Wm)(p,{style:{color:"red"},name:"percent",class:"invalid-feeback"})]),(0,a._)("div",N,[q,(0,a.Wm)(d,{class:(0,s.C_)(["my-2 p-2",{is_invalid:e["due_date"]}]),id:"due_date",name:"due_date",type:"date",rules:"required",modelValue:l.due_date,"onUpdate:modelValue":t[2]||(t[2]=e=>l.due_date=e)},null,8,["class","modelValue"]),(0,a.Wm)(p,{style:{color:"red"},name:"due_date",class:"invalid-feeback"})]),(0,a._)("div",P,[U,(0,a._)("div",{class:(0,s.C_)(["toggle",{active:1===l.tempCoupon.is_enabled}]),onClick:t[3]||(t[3]=e=>0==l.tempCoupon.is_enabled?l.tempCoupon.is_enabled=1:l.tempCoupon.is_enabled=0)},null,2)]),(0,a._)("div",Z,[L,(0,a.Wm)(d,{class:(0,s.C_)(["my-2 p-2",{is_invalid:e["code"]}]),id:"code",name:"code",type:"text",rules:"required",modelValue:l.tempCoupon.code,"onUpdate:modelValue":t[4]||(t[4]=e=>l.tempCoupon.code=e)},null,8,["class","modelValue"]),(0,a.Wm)(p,{style:{color:"red"},name:"code",class:"invalid-feeback"})])])),_:1}),(0,a._)("div",F,[(0,a._)("a",{class:"btn btn--danger py-2 w-30 pointer",herf:"#",onClick:t[5]||(t[5]=(0,n.iM)((t=>e.$emit("closeBack")),["prevent"]))},"取消"),(0,a._)("a",{class:"btn btn--success py-2 w-30 pointer",herf:"#",onClick:t[6]||(t[6]=(0,n.iM)((t=>e.$emit("updateCoupon",l.tempCoupon)),["prevent"]))},"送出")])])):(0,a.kq)("",!0)}var E={props:["coupon","isNew"],emits:["updateCoupon","closeBack"],data(){return{tempCoupon:{is_enabled:0},due_date:"",is_show:!1}},methods:{openModal(){this.is_show=!0},closeModal(){this.is_show=!1}},watch:{coupon(){this.isNew?this.tempCoupon={...this.coupon,is_enabled:0}:this.tempCoupon=this.coupon;const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");this.due_date=e[0]},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}}},H=o(89);const I=(0,H.Z)(E,[["render",O]]);var Y=I,G=o(7453),K=o(1894),T={data(){return{isNew:!1,coupons:[],tempCoupon:{},pagination:{},back_show:!1}},components:{ModalView:Y,DelModal:G.Z,PageView:K.Z},methods:{updateCoupon(e,t=""){this.$emitter.emit("isAdminLoading",!0);let o="https://vue3-course-api.hexschool.io/v2/api/ginjack/admin/coupon",a="post",s="增加優惠卷";this.tempCoupon=e,this.isNew||(a="put",o=`https://vue3-course-api.hexschool.io/v2/api/ginjack/admin/coupon/${this.tempCoupon.id}`,s="更新優惠卷"),this.$http[a](o,{data:this.tempCoupon}).then((e=>{this.$refs.couponModal.closeModal(),this.getCoupon(this.pagination.current_page),this.back_show=!1,this.$httpMessageState(e,s)})).catch((e=>{this.$emitter.emit("isAdminLoading",!1),this.$httpMessageState(e.response,s)}))},getCoupon(e=1){this.$emitter.emit("isAdminLoading",!0),this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/ginjack/admin/coupons?page=${e}`).then((e=>{this.coupons=e.data.coupons,this.pagination=e.data.pagination,this.$emitter.emit("isAdminLoading",!1)})).catch((e=>{this.$emitter.emit("isAdminLoading",!1),this.$httpMessageState(e.response,"獲取優惠卷列表")}))},delCoupon(e){this.$emitter.emit("isAdminLoading",!0),this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ginjack/admin/coupon/${e}`).then((e=>{this.$refs.delModal.closeModal(),this.getCoupon(this.pagination.current_page),this.back_show=!1,this.$httpMessageState(e,"刪除優惠卷")})).catch((e=>{this.$emitter.emit("isAdminLoading",!1),this.$httpMessageState(e.response,"刪除優惠卷")}))},openDelModal(e,t){this.back_show=!0,this.tempCoupon={...t},this.$refs.delModal.openModal(e)},openCouponModal(e,t){this.back_show=!0,this.isNew=e,this.isNew?this.tempCoupon={due_date:(new Date).getTime()/1e3}:this.tempCoupon={...t},this.$refs.couponModal.openModal()},closeAllModal(){this.$refs.couponModal.closeModal(),this.$refs.delModal.closeModal(),this.back_show=!1}},mounted(){this.getCoupon()}};const J=(0,H.Z)(T,[["render",D]]);var Q=J}}]);
//# sourceMappingURL=68.568f40e3.js.map